# Quarkus Application Configuration for Helios Rule Engine

# Application name
quarkus.application.name=helios-rule-engine

# HTTP Server Configuration
quarkus.http.port=8080
quarkus.http.host=0.0.0.0

# REST API Configuration
quarkus.rest.path=/api/v1

# Enable HTTP/2 support
quarkus.http.http2=true

# Thread pool configuration (optimize for high throughput)
quarkus.thread-pool.core-threads=${THREAD_POOL_CORE:16}
quarkus.thread-pool.max-threads=${THREAD_POOL_MAX:200}

# Rules Configuration
rules.file=${RULES_FILE:rules.json}

# Database Configuration
# H2 in-memory database for development (default)
quarkus.datasource.db-kind=h2
quarkus.datasource.username=sa
quarkus.datasource.password=
quarkus.datasource.jdbc.url=jdbc:h2:mem:helios;DB_CLOSE_DELAY=-1

# Connection pool configuration
quarkus.datasource.jdbc.min-size=5
quarkus.datasource.jdbc.max-size=20

# Health Check Configuration
quarkus.smallrye-health.root-path=/health
quarkus.smallrye-health.liveness-path=/health/live
quarkus.smallrye-health.readiness-path=/health/ready

# OpenTelemetry Configuration
# TODO: Fix OpenTelemetry version conflict with helios-core
quarkus.otel.enabled=${OTEL_ENABLED:false}
quarkus.otel.exporter.otlp.endpoint=${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4317}
quarkus.otel.traces.sampler=${OTEL_TRACES_SAMPLER:traceidratio}
quarkus.otel.traces.sampler.arg=${OTEL_TRACE_SAMPLING_RATIO:1.0}

# Service identification for telemetry
quarkus.otel.resource.attributes=service.name=helios-rule-engine,service.version=1.0.0,deployment.environment=${DEPLOYMENT_ENVIRONMENT:dev}

# Logging Configuration
quarkus.log.level=${LOG_LEVEL:INFO}
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Java 25 module system configuration
quarkus.native.additional-build-args=--add-opens=java.base/java.lang=ALL-UNNAMED

# Jackson Configuration (for JSON serialization)
quarkus.jackson.fail-on-unknown-properties=false
quarkus.jackson.write-dates-as-timestamps=false

# Development mode settings (H2 in-memory)
%dev.quarkus.log.level=DEBUG
%dev.quarkus.otel.enabled=false
%dev.quarkus.http.port=8080
%dev.quarkus.datasource.db-kind=h2
%dev.quarkus.datasource.jdbc.url=jdbc:h2:mem:helios;DB_CLOSE_DELAY=-1

# File-based H2 profile (for development with persistence)
%dev-file.quarkus.datasource.db-kind=h2
%dev-file.quarkus.datasource.jdbc.url=jdbc:h2:file:./data/helios;AUTO_SERVER=TRUE

# PostgreSQL profile (for production)
%postgres.quarkus.datasource.db-kind=postgresql
%postgres.quarkus.datasource.username=${DB_USERNAME:helios}
%postgres.quarkus.datasource.password=${DB_PASSWORD:helios}
%postgres.quarkus.datasource.jdbc.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/helios}
%postgres.quarkus.datasource.jdbc.min-size=10
%postgres.quarkus.datasource.jdbc.max-size=50

# Production settings
%prod.quarkus.log.level=INFO
%prod.quarkus.otel.enabled=true
%prod.quarkus.otel.traces.sampler.arg=0.1
